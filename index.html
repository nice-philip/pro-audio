<!DOCTYPE html>
<head>
	<!--
    	Pro Audio
    	http://www.templatemo.com/preview/templatemo_429_pro_audio
    -->
	<title>Pro Audio - Free Responsive Template</title>
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet" type="text/css">
	<link href="css/font-awesome.min.css" rel="stylesheet">
	<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="css/templatemo_style.css" rel="stylesheet" type="text/css">
</head>
<body>
	<nav id="responsive-menu">
        <ul class="menu-holder">
            <li><a href="#home"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="#subscribe"><i class="fa fa-briefcase"></i>预约申请</a></li>
            <li><a href="#albums"><i class="fa fa-cogs"></i>Albums</a></li>
            <li><a href="#about"><i class="fa fa-list"></i>About</a></li>
            <li><a href="#services"><i class="fa fa-list"></i>Services</a></li>            
            <li><a href="#contact"><i class="fa fa-briefcase"></i>Contact</a></li>
        </ul>
    </nav>
	<div class="templatemo-header">		
		<div class="templatemo-header-gradient-bg"></div>
		<div class="container">			
			<h1 class="text-center text-uppercase templatemo-site-name"><span class="blue">Pro</span> Audio</h1>
			<nav class="hidden-xs text-center text-uppercase templatemo-nav">
				<ul class="menu-holder">
					<li class="active"><a href="#home">Home</a></li>
					<li><a href="#subscribe">预约申请</a></li>
					<li><a href="#albums">Albums</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#services">services</a></li>					
					<li><a href="#contact">Contact</a></li>
				</ul>
			</nav>
			<div class="text-right visible-xs">
	            <a href="#" id="mobile_menu"><span class="fa fa-bars"></span></a>
	        </div>
		</div>
	</div>
	<div class="templatemo-header-image"></div>
	<div class="container">
		<section id="home" class="templatemo-section">
			<div class="row">
				<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
					<img src="images/home.png" alt="Banner" class="img-responsive center-block">				
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
					<h2 class="text-right">High Quality</h2>					
					<h3 class="text-uppercase text-right margin-top-30">free responsive template</h3>
					<p class="text-right margin-top-30">Pro Audio is free responsive template for sound or musical websites.<br>
 					This template is provided by templatemo. Credits go to <a rel="nofollow" href="http://www.smashingmagazine.com/2012/11/20/art-professions-icons-png/">Art Professions</a> Icon and <a rel="nofollow" href="http://unsplash.com">Unsplash</a> for images used in this template.</p>
					<a href="#" class="pull-right btn-gradient margin-top-30 text-uppercase">Lorem ip</a>
				</div>
			</div>	
		</section>
		<img src="images/border.png" alt="Border" class="templatemo-border">
		<section id="subscribe" class="templatemo-section">
			<h2 class="text-uppercase text-center">预约申请</h2>
			<div class="upload-section margin-top-50">
				<button onclick="openAccordion()" class="btn text-uppercase tm-dark-bg tm-orange-text tm-send-btn btn-gradient">📩 申请专辑制作</button>
			</div>
			<div id="accordionContent" style="max-height: 0; overflow: hidden; transition: max-height 0.7s ease;">
				<div class="row margin-top-50">
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<form id="albumForm" class="tm-contact-form" onsubmit="handleSubmit(event)">
							<div class="form-group">
								<input type="text" id="name" name="name" class="form-control" placeholder="姓名..." required>
							</div>
							<div class="form-group">
								<input type="number" id="age" name="age" class="form-control" placeholder="年龄..." required>
							</div>
							<div class="form-group">
								<select id="gender" name="gender" class="form-control" required>
									<option value="">选择性别...</option>
									<option value="男">男</option>
									<option value="女">女</option>
									<option value="其他">其他</option>
								</select>
							</div>
							<div class="form-group">
								<input type="email" id="email" name="email" class="form-control" placeholder="邮箱..." required>
							</div>
							<div class="form-group">
								<input type="date" id="date" name="date" class="form-control" required>
							</div>
							<div class="form-group">
								<input type="time" id="time" name="time" class="form-control" placeholder="专辑时长..." required>
							</div>
							<div class="form-group">
								<textarea id="mainRequest" name="mainRequest" class="form-control" rows="6" placeholder="专辑介绍 + 曲目名"></textarea>
							</div>
							<div class="form-group">
								<textarea id="note" name="note" class="form-control" rows="4" placeholder="备注"></textarea>
							</div>
							<div class="form-group">
								<input type="text" id="memberKey" name="memberKey" class="form-control" placeholder="预约编号(用于确认)" required>
							</div>
							<div class="form-group">
								<input type="file" id="audio" name="audio" class="form-control" accept=".mp3,.wav" required>
							</div>
							<button type="submit" class="btn text-uppercase tm-dark-bg tm-orange-text tm-send-btn btn-gradient">申请完成</button>
						</form>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="reservation-check">
							<h3 class="text-uppercase text-center">预约查询</h3>
							<div class="form-group margin-top-30">
								<input type="text" id="searchMemberKey" class="form-control" placeholder="输入预约号码..." />
							</div>
							<button onclick="checkReservation()" class="btn text-uppercase tm-dark-bg tm-orange-text tm-send-btn btn-gradient">查询预约</button>
							<div id="reservationResults" class="margin-top-30" style="display: none;">
								<table class="table table-bordered">
									<thead>
										<tr>
											<th>预约号码</th>
											<th>姓名</th>
											<th>预约日期</th>
											<th>时长</th>
											<th>状态</th>
										</tr>
									</thead>
									<tbody id="reservationTableBody">
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<img src="images/border.png" alt="Border" class="templatemo-border">
		<section id="albums" class="templatemo-section">
			<h2 class="text-uppercase text-center">Albums</h2>
			<div class="row margin-top-50 templatemo-albums-container">
				<div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
					<div class="templatemo-album-images">
						<img src="images/albums/1.jpg" alt="Album 1" class="img-circle templatemo-album-img">
						<img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
						<img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
						<audio id="audio1" src="audio\song1.mp3"></audio>
						<audio id="audio2" src="audio\song2.mp3"></audio>
						<div class="audio-player" id="player1">
							<div class="play-pause-btn" onclick="togglePlay(1)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress1"></div>
							</div>
						</div>
						<div class="audio-player" id="player2">
							<div class="play-pause-btn" onclick="togglePlay(2)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress2"></div>
							</div>
						</div>
					</div>					
					<div class="templatemo-album-description">
						<p class="templatemo-album-name" onclick="togglePlay(1)" style="cursor: pointer;">First Album</p>
						<p class="templatemo-album-artist" onclick="togglePlay(2)" style="cursor: pointer;">Artist One</p>
						<p class="templatemo-album-date" onclick="stopAudio()" style="cursor: pointer;">Pop/Rock</p>	
					</div>				
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
					<div class="templatemo-album-images">
						<img src="images/albums/2.jpg" alt="Album 2" class="img-circle templatemo-album-img">
						<img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
						<img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
						<audio id="audio3" src="audio\song3.mp3"></audio>
						<audio id="audio4" src="audio\song4.mp3"></audio>
						<div class="audio-player" id="player3">
							<div class="play-pause-btn" onclick="togglePlay(3)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress3"></div>
							</div>
						</div>
						<div class="audio-player" id="player4">
							<div class="play-pause-btn" onclick="togglePlay(4)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress4"></div>
							</div>
						</div>
					</div>
					<div class="templatemo-album-description">
						<p class="templatemo-album-name" onclick="togglePlay(3)" style="cursor: pointer;">Album Two</p>
						<p class="templatemo-album-artist" onclick="togglePlay(4)" style="cursor: pointer;">Second Artist</p>
						<p class="templatemo-album-date" onclick="stopAudio()" style="cursor: pointer;">Hip Hop</p>	
					</div>				
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
					<div class="templatemo-album-images">
						<img src="images/albums/3.jpg" alt="Album 3" class="img-circle templatemo-album-img">
						<img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
						<img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
						<audio id="audio5" src="audio\song5.mp3"></audio>
						<audio id="audio6" src="audio\song6.mp3"></audio>
						<div class="audio-player" id="player5">
							<div class="play-pause-btn" onclick="togglePlay(5)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress5"></div>
							</div>
						</div>
						<div class="audio-player" id="player6">
							<div class="play-pause-btn" onclick="togglePlay(6)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress6"></div>
							</div>
						</div>
					</div>
					<div class="templatemo-album-description">
						<p class="templatemo-album-name" onclick="togglePlay(5)" style="cursor: pointer;">Third Album</p>
						<p class="templatemo-album-artist" onclick="togglePlay(6)" style="cursor: pointer;">Artist Three</p>
						<p class="templatemo-album-date" onclick="stopAudio()" style="cursor: pointer;">Electronic</p>	
					</div>				
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
					<div class="templatemo-album-images">
						<img src="images/albums/4.jpg" alt="Album 4" class="img-circle templatemo-album-img">
						<img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
						<img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
						<audio id="audio7" src="audio\song7.mp3"></audio>
						<audio id="audio8" src="audio\song8.mp3"></audio>
						<div class="audio-player" id="player7">
							<div class="play-pause-btn" onclick="togglePlay(7)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress7"></div>
							</div>
						</div>
						<div class="audio-player" id="player8">
							<div class="play-pause-btn" onclick="togglePlay(8)">
								<i class="fa fa-play"></i>
							</div>
							<div class="progress-bar">
								<div class="progress" id="progress8"></div>
							</div>
						</div>
					</div>
					<div class="templatemo-album-description">
						<p class="templatemo-album-name" onclick="togglePlay(7)" style="cursor: pointer;">Album Four</p>
						<p class="templatemo-album-artist" onclick="togglePlay(8)" style="cursor: pointer;">Fourth Artist</p>
						<p class="templatemo-album-date" onclick="stopAudio()" style="cursor: pointer;">Techno</p>	
					</div>				
				</div>	
			</div>				
		</section>
		<img src="images/border.png" alt="Border" class="templatemo-border">
		<section id="about" class="templatemo-section">
			<h2 class="text-uppercase text-center">About</h2>
			<div class="tm-about-img-container">
				<img src="images/about-frame.png" alt="About frame" class="tm-about-frame img-responsive">
				<img src="images/about.jpg" alt="About" class="tm-about-img img-responsive">
			</div>			
			<p class="margin-top-50 text-center">Nunc et nisi eu eros posuere congue. Nulla vitae iaculis metus, sed gravida metus. Donec mauris lorem, molestie vitae ultrices non, sodales quis tortor. Aenean ornare, purus id convallis rhoncus, felis lacus facilisis quam, in sollicitudin est sem ut ante. <a href="#">Lorem ipsum</a> dolor sit amet, consectetur adipiscing elit. Aenean quis eros quis lacus interdum accumsan id ut ante. Duis gravida massa sit amet malesuada tincidunt.</p>
		</section>
		<img src="images/border.png" alt="Border" class="templatemo-border">
		<section id="services" class="templatemo-section">
			<h2 class="text-uppercase text-center">Services</h2>
			<div class="row margin-top-50">
				<article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
					<img src="images/services/1.png" alt="Product 1" class="center-block">
					<h3 class="text-uppercase text-center">aenean socitun</h3>
					<p class="text-center">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean quis eros quis lacus interdum accumsan id ut ante.</p>
				</article>
				<article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
					<img src="images/services/2.png" alt="Product 2" class="center-block">
					<h3 class="text-uppercase text-center">Donec mauris lorem</h3>
					<p class="text-center">Nam ornare blandit ultrices. Aliquam facilisis quam eget nunc consectetur volutpat. Sed bibendum felis id erat cursus, ac volutpat metus ornare.</p>
				</article>
				<article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
					<img src="images/services/3.png" alt="Product 3" class="center-block">
					<h3 class="text-uppercase text-center">Curabitur elementum</h3>
					<p class="text-center">Aenean quis eros quis lacus interdum accumsan id ut ante. Curabitur elementum enim turpis, sed pharetra purus ornare sit amet.</p>
				</article>				
			</div>
		</section>		
		<img src="images/border.png" alt="Border" class="templatemo-border">
		<section id="contact" class="templatemo-section">
			<h2 class="text-uppercase text-center">Contact</h2>
			<div class="margin-top-50">
				<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
		        	<div id="map-canvas"></div>	
		        </div>
		        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
		            <form id="contactForm" class="tm-contact-form">
		                <div class="form-group">
		                    <input type="text" id="contact_name" class="form-control" placeholder="Name..." required />
		                </div>
		                <div class="form-group">
		                    <input type="email" id="contact_email" class="form-control" placeholder="Email..." required />
		                </div>
		                <div class="form-group">
		                    <input type="text" id="contact_subject" class="form-control" placeholder="Subject..." required />
		                </div>
		                <div class="form-group">
		                    <textarea id="contact_message" class="form-control" rows="8" placeholder="Your message..." required></textarea>
		                </div>
		                <button type="submit" class="btn text-uppercase tm-dark-bg tm-orange-text tm-send-btn btn-gradient">Send</button>
		            </form>
		        </div>
			</div>
		</section>
	</div>	
	<footer class="templatemo-footer margin-top-50">
		<div class="container">
			<p class="text-uppercase small templatemo-copyright">Copyright &copy; 2084 <a href="#">Company Name</a></p>
			<img src="images/go-to-top.png" alt="Go to top" class="img-responsive tm-go-to-top">
		</div>		
	</footer>
	<script src="js/jquery-1.11.1.min.js"></script>
	<script src="js/templatemo_script.js"></script>
	<style>
		.audio-player {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			display: none;
			width: 80%;
			text-align: center;
			z-index: 10;
		}
		
		.play-pause-btn {
			background: rgba(255, 255, 255, 0.8);
			border-radius: 50%;
			width: 50px;
			height: 50px;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			margin: 0 auto 10px;
		}
		
		.progress-bar {
			background: rgba(255, 255, 255, 0.3);
			height: 5px;
			border-radius: 3px;
			overflow: hidden;
		}
		
		.progress {
			background: #fff;
			height: 100%;
			width: 0;
			transition: width 0.1s linear;
		}

		.templatemo-album-images {
			position: relative;
		}

		.templatemo-album-name, .templatemo-album-artist {
			transition: color 0.3s ease;
		}

		.templatemo-album-name:hover, .templatemo-album-artist:hover {
			color: #ff6633;
		}

		.templatemo-album-date {
			transition: color 0.3s ease;
		}
		.templatemo-album-date:hover {
			color: #ff6633;
		}
	</style>
	<script>
		function openAccordion() {
			const content = document.getElementById('accordionContent');
			if (content.style.maxHeight && content.style.maxHeight !== '0px') {
				content.style.maxHeight = '0px';
			} else {
				content.style.maxHeight = '2000px';
			}
		}

		function handleSubmit(event) {
			event.preventDefault();

			const form = document.getElementById('albumForm');
			const formData = new FormData(form);

			fetch("https://recording-2-eqha.onrender.com/api/upload", {
				method: "POST",
				body: formData
			})
			.then(response => {
				if (!response.ok) {
					throw new Error("服务器错误");
				}
				return response.json();
			})
			.then(data => {
				alert("🎉 申请已完成！");
				form.reset();
				document.getElementById('accordionContent').style.maxHeight = '0px';
			})
			.catch(error => {
				console.error("上传失败:", error);
				alert("上传失败，请稍后重试。");
			});
		}

		async function checkReservation() {
			const memberKey = document.getElementById('searchMemberKey').value;
			if (!memberKey) {
				alert('请输入预约号码');
				return;
			}

			try {
				const response = await fetch(`/api/reservations?key=${memberKey}`);
				const result = await response.json();
				
				if (response.ok) {
					displayReservations(result);
				} else {
					alert('查询失败：' + result.message);
				}
			} catch (error) {
				console.error('Error:', error);
				alert('查询失败，请稍后重试');
			}
		}

		function displayReservations(reservations) {
			const tableBody = document.getElementById('reservationTableBody');
			const resultsDiv = document.getElementById('reservationResults');
			
			tableBody.innerHTML = '';
			
			reservations.forEach(reservation => {
				const row = document.createElement('tr');
				row.innerHTML = `
					<td>${reservation.reservationCode}</td>
					<td>${reservation.name}</td>
					<td>${new Date(reservation.date).toLocaleDateString()}</td>
					<td>${reservation.albumLength}</td>
					<td>处理中</td>
				`;
				tableBody.appendChild(row);
			});
			
			resultsDiv.style.display = 'block';
		}

		// Contact Form Submission
		document.getElementById('contactForm').addEventListener('submit', function(e) {
			e.preventDefault();
			
			const formData = {
				name: document.getElementById('contact_name').value,
				email: document.getElementById('contact_email').value,
				subject: document.getElementById('contact_subject').value,
				message: document.getElementById('contact_message').value
			};

			// EmailJS 초기화
			(function() {
				emailjs.init("jfle4pXv1E8FEPCJv"); // Public Key
			})();

			// 이메일 전송
			emailjs.send(
				"service_jsn3q06", // Service ID
				"template_ha65rt7", // Template ID
				{
					to_email: "kmat0@naver.com",
					from_name: formData.name,
					from_email: formData.email,
					subject: formData.subject,
					message: formData.message
				}
			).then(
				function(response) {
					alert("메시지가 성공적으로 전송되었습니다!");
					document.getElementById('contactForm').reset();
				},
				function(error) {
					console.error("전송 실패:", error);
					alert("메시지 전송에 실패했습니다. 다시 시도해주세요.");
				}
			);
		});

		// Audio Player Functionality
		let currentlyPlaying = null;
		let currentPlayer = null;
		const players = {};

		function togglePlay(id) {
			const audio = document.getElementById(`audio${id}`);
			const player = document.getElementById(`player${id}`);
			const playBtn = player.querySelector('.play-pause-btn i');
			const progress = document.getElementById(`progress${id}`);

			if (currentlyPlaying && currentlyPlaying !== audio) {
				currentlyPlaying.pause();
				const oldPlayBtn = currentPlayer.querySelector('.play-pause-btn i');
				oldPlayBtn.className = 'fa fa-play';
				currentPlayer.style.display = 'none';
			}

			if (audio.paused) {
				audio.play();
				player.style.display = 'block';
				playBtn.className = 'fa fa-pause';
				currentlyPlaying = audio;
				currentPlayer = player;
			} else {
				audio.pause();
				player.style.display = 'none';
				playBtn.className = 'fa fa-play';
				currentlyPlaying = null;
				currentPlayer = null;
			}

			if (!players[id]) {
				players[id] = true;
				audio.addEventListener('timeupdate', () => {
					const progressPercent = (audio.currentTime / audio.duration) * 100;
					progress.style.width = `${progressPercent}%`;
				});

				audio.addEventListener('ended', () => {
					player.style.display = 'none';
					playBtn.className = 'fa fa-play';
					progress.style.width = '0%';
					currentlyPlaying = null;
					currentPlayer = null;
				});
			}
		}

		function stopAudio() {
			if (currentlyPlaying) {
				currentlyPlaying.pause();
				currentlyPlaying.currentTime = 0;
				const player = currentPlayer;
				const playBtn = player.querySelector('.play-pause-btn i');
				player.style.display = 'none';
				playBtn.className = 'fa fa-play';
				const progress = player.querySelector('.progress');
				progress.style.width = '0%';
				currentlyPlaying = null;
				currentPlayer = null;
			}
		}
	</script>
	<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</body>
</html>
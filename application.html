<!DOCTYPE html>
<html lang="ja-JP">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アルバム申請 - Surroundio</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/application.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=AUAys9sigvI9TtgDkQMRtQxfrXspOUiEp9CUafMtSagb2r_Av6rYByXOrkRkQIg7weOtYlGKfJMxRuK_&currency=JPY&intent=capture"></script>
    <style>
        .form-section {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .audio-specs-table {
            width: 100%;
            margin: 20px 0;
        }
        .audio-specs-table th, .audio-specs-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        .audio-specs-table th {
            background-color: #f8f9fa;
        }
        .youtube-terms {
            height: 200px;
            overflow-y: scroll;
            padding: 15px;
            border: 1px solid #ddd;
            margin-bottom: 15px;
            background: #f8f9fa;
        }
        .required-label::after {
            content: "*";
            color: red;
            margin-left: 4px;
        }
        .image-upload-guide {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        .classic-fields {
            display: none;
        }
        #genre {
            max-height: 38px;
        }
        /* Pastel button styles */
        .btn-pastel {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none !important;
            display: inline-block;
            margin: 5px;
            color: #2C3333 !important;
        }

        .classical-required::after {
            content: "*";
            color: red;
            margin-left: 4px;
        }
        /* PayPal Button Styles */
        #paypal-button-container {
            max-width: 500px;
            margin: 20px auto;
        }
        .payment-status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .payment-status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .payment-status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .add-button {
            background: #C1FFD7;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            margin: 5px 0;
            cursor: pointer;
        }
        .add-button:hover { background: #B4EBC5; }
        .input-group { margin-bottom: 10px; }
        .checkbox-group { margin: 15px 0; }
        .language-section { margin: 20px 0; }
        .platform-section { 
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .terms-section {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .terms-content {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            margin: 10px 0;
            background: white;
            border: 1px solid #ddd;
        }
        .image-upload-info {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .dynamic-input-container { margin-top: 10px; }
        .remove-input {
            color: red;
            cursor: pointer;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <a href="/index" class="btn btn-outline-primary">
                <i class="fa fa-home"></i> <span>ホームへ戻る</span>
            </a>
            <h1 class="mb-0">アルバム申請</h1>
            <div style="width: 100px;"></div>
        </div>
        <form id="albumForm" class="needs-validation" novalidate>
            <!-- 基本情報 -->
            <div class="form-section">
                <h3 class="mb-4">基本情報</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label required-label">メールアドレス</label>
                        <input type="email" class="form-control" id="email" name="email" required>
                        <div class="invalid-feedback">
                            有効なメールアドレスを入力してください（@を含む必要があります）
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="password" class="form-label required-label">パスワード</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                        <div class="invalid-feedback">
                            パスワードを入力してください
                        </div>
                        <small class="text-muted">予約確認時に必要となります</small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="albumNameDomestic" class="form-label required-label">アルバム名（国内）</label>
                        <input type="text" class="form-control" id="albumNameDomestic" name="albumNameDomestic" placeholder="アルバム名を入力してください" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="albumNameInternational" class="form-label required-label">アルバム名（海外）</label>
                        <input type="text" class="form-control" id="albumNameInternational" name="albumNameInternational" placeholder="アルバム名を入力してください" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="artistNameKana" class="form-label required-label">アーティスト名（カナ）</label>
                        <input type="text" class="form-control" id="artistNameKana" name="artistNameKana" placeholder="アーティスト名をカタカナで入力してください" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="artistNameEnglish" class="form-label required-label">アーティスト名（英文）</label>
                        <input type="text" class="form-control" id="artistNameEnglish" name="artistNameEnglish" placeholder="Enter artist name in English" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <label for="versionInfo" class="form-label required-label">バージョン情報</label>
                        <input type="text" class="form-control" id="versionInfo" name="versionInfo" placeholder="アルバムバージョン情報を入力してください(例: Holiday Remix / Instrumental Version)" required>
                    </div>
                </div>
            </div>

            <!-- 楽曲情報 -->
            <div class="form-section">
                <h3 class="mb-4">楽曲情報</h3>
                <button type="button" class="btn btn-success mb-3" id="addSongButton">
                    <i class="fa fa-plus"></i> 楽曲を追加
                </button>
                <div id="songs-container">
                    <!-- Template for song entry -->
                    <div class="song-entry mb-4 p-3 border rounded" data-song-index="0">
                        <h4 class="d-flex justify-content-between align-items-center">
                            楽曲 #<span class="song-number">1</span>
                            <button type="button" class="btn btn-danger remove-song" style="display: none;">
                                <i class="fa fa-trash"></i>
                            </button>
                        </h4>

                        <!-- アーティスト情報 -->
                        <div class="artist-section mb-4">
                            <h5>アーティスト情報</h5>
                            <div id="mainArtistContainer_0" class="mb-3">
                                <label class="form-label required-label">メインアーティスト</label>
                                <div class="input-group">
                                    <input type="text" name="mainArtist_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="participatingArtistContainer_0" class="mb-3">
                                <label class="form-label required-label">参加アーティスト</label>
                                <div class="input-group">
                                    <input type="text" name="participatingArtist_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="featuringContainer_0" class="mb-3">
                                <label class="form-label">フィーチャリングアーティスト</label>
                                <div class="input-group">
                                    <input type="text" name="featuring_0[]" class="form-control">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="mixingEngineerContainer_0" class="mb-3">
                                <label class="form-label required-label">ミキシングエンジニア</label>
                                <div class="input-group">
                                    <input type="text" name="mixingEngineer_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="recordingEngineerContainer_0" class="mb-3">
                                <label class="form-label required-label">レコーディングエンジニア</label>
                                <div class="input-group">
                                    <input type="text" name="recordingEngineer_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="producerContainer_0" class="mb-3">
                                <label class="form-label required-label">プロデューサー</label>
                                <div class="input-group">
                                    <input type="text" name="producer_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 作者情報 -->
                        <div class="creator-section mb-4">
                            <h5>作者情報</h5>
                            <div id="lyricistContainer_0" class="mb-3">
                                <label class="form-label required-label">作詞</label>
                                <div class="input-group">
                                    <input type="text" name="lyricist_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="composerContainer_0" class="mb-3">
                                <label class="form-label required-label">作曲</label>
                                <div class="input-group">
                                    <input type="text" name="composer_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>

                            <div id="arrangerContainer_0" class="mb-3">
                                <label class="form-label required-label">編曲</label>
                                <div class="input-group">
                                    <input type="text" name="arranger_0[]" class="form-control" required>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-success add-field">+</button>
                                        <button type="button" class="btn btn-danger remove-field">-</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- その他の情報 -->
                        <div class="other-info-section">
                            <h5>その他の情報</h5>
                            <div class="mb-3">
                                <label class="form-label required-label">音声ファイル（WAV形式）</label>
                                <input type="file" class="form-control" name="audio_0" accept=".wav" required>
                                <div class="alert alert-warning mt-2">
                                    <p class="text-danger">※ 音声ファイルは以下の規格を必ず守ってください：</p>
                                    <ul>
                                        <li>ファイル形式: WAV</li>
                                        <li>サンプリングレート: 44.1kHz または 48kHz</li>
                                        <li>ビット深度: 16bit または 24bit</li>
                                        <li>チャンネル: ステレオ</li>
                                        <li>ファイルサイズ: 2GB以下</li>
                                    </ul>
                                    <p>※ 音声ファイルが規格外の場合、音質の低下や処理の遅延が発生する可能性があります。</p>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">リメイク曲ですか？</label>
                                <div class="form-check">
                                    <input type="radio" class="form-check-input" name="isRemake_0" value="yes" required>
                                    <label class="form-check-label">はい</label>
                                </div>
                                <div class="form-check">
                                    <input type="radio" class="form-check-input" name="isRemake_0" value="no" required>
                                    <label class="form-check-label">いいえ</label>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">外部購入ビート/サンプルを使用していますか？</label>
                                <div class="form-check">
                                    <input type="radio" class="form-check-input" name="usesExternalBeat_0" value="yes" required>
                                    <label class="form-check-label">はい</label>
                                </div>
                                <div class="form-check">
                                    <input type="radio" class="form-check-input" name="usesExternalBeat_0" value="no" required>
                                    <label class="form-check-label">いいえ</label>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label required-label">言語</label>
                                <select class="form-select" name="language_0" required>
                                    <option value="instrumental">演奏（言語なし）</option>
                                    <option value="japanese">日本語</option>
                                    <option value="english">英語</option>
                                    <option value="korean">韓国語</option>
                                    <option value="chinese">中国語</option>
                                    <option value="spanish">スペイン語</option>
                                    <option value="french">フランス語</option>
                                    <option value="german">ドイツ語</option>
                                    <option value="italian">イタリア語</option>
                                    <option value="portuguese">ポルトガル語</option>
                                    <option value="russian">ロシア語</option>
                                    <option value="arabic">アラビア語</option>
                                    <option value="hindi">ヒンディー語</option>
                                    <option value="bengali">ベンガル語</option>
                                    <option value="punjabi">パンジャブ語</option>
                                    <option value="javanese">ジャワ語</option>
                                    <option value="vietnamese">ベトナム語</option>
                                    <option value="thai">タイ語</option>
                                    <option value="turkish">トルコ語</option>
                                    <option value="persian">ペルシャ語</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">歌詞</label>
                                <textarea class="form-control" name="lyrics_0" rows="5"></textarea>
                                <div class="alert alert-warning mt-2">
                                    <p>- 歌詞に性的な内容や暴言が含まれている場合、禁止事項をチェックしてください。</p>
                                    <p>- 歌詞に性的な内容や暴言が含まれているにもかかわらず禁止事項のチェックがない場合、当社の方針により歌詞サービスが制限される可能性があります。</p>
                                    <p>- 商標が歌詞に含まれる場合、各プラットフォームの方針により歌詞サービスが制限される可能性があります。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- アルバム全体の情報 -->
            <div class="form-section">
                <h3>アルバム全体の情報</h3>
                <div class="mb-3">
                    <label class="form-label required-label">アルバムカバー</label>
                    <input type="file" class="form-control" name="albumCover" accept=".jpg,.jpeg,.png" required>
                    <div class="alert alert-warning mt-2">
                        <p class="text-danger">※ 商標や商用イメージは使用できません</p>
                        <p><strong>アルバムカバーは以下の規格を必ず守ってください：</strong></p>
                        <p>3,000x3,000px、10MB以下の正方形JPG、PNGイメージ</p>
                    </div>
                </div>

                <!-- プラットフォーム選択 -->
                <div class="platform-section">
                    <h4>発売を希望するプラットフォーム</h4>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="spotify">
                                <label class="form-check-label">Spotify</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="apple_music">
                                <label class="form-check-label">Apple Music</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="youtube_music">
                                <label class="form-check-label">YouTube Music</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="amazon_music">
                                <label class="form-check-label">Amazon Music</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="tidal">
                                <label class="form-check-label">TIDAL</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="deezer">
                                <label class="form-check-label">Deezer</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="pandora">
                                <label class="form-check-label">Pandora</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="soundcloud">
                                <label class="form-check-label">SoundCloud</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="napster">
                                <label class="form-check-label">Napster</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="anghami">
                                <label class="form-check-label">Anghami</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="joox">
                                <label class="form-check-label">JOOX</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="kkbox">
                                <label class="form-check-label">KKBOX</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="line_music">
                                <label class="form-check-label">LINE MUSIC</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="qq_music">
                                <label class="form-check-label">QQ Music</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" name="platforms[]" value="netease">
                                <label class="form-check-label">NetEase Cloud Music</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 除外国選択 -->
                <div class="mb-3">
                    <label class="form-label">発売を希望しない国</label>
                    <button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#excludedCountriesCollapse" aria-expanded="false" aria-controls="excludedCountriesCollapse">
                        国を選択 (クリックして展開)
                    </button>
                    <div class="collapse" id="excludedCountriesCollapse">
                        <div class="card card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <h6>アジア</h6>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="JP">
                                        <label class="form-check-label">日本</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CN">
                                        <label class="form-check-label">中国</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="KR">
                                        <label class="form-check-label">韓国</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="TW">
                                        <label class="form-check-label">台湾</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="HK">
                                        <label class="form-check-label">香港</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="SG">
                                        <label class="form-check-label">シンガポール</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="MY">
                                        <label class="form-check-label">マレーシア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="ID">
                                        <label class="form-check-label">インドネシア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="TH">
                                        <label class="form-check-label">タイ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="VN">
                                        <label class="form-check-label">ベトナム</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PH">
                                        <label class="form-check-label">フィリピン</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="IN">
                                        <label class="form-check-label">インド</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PK">
                                        <label class="form-check-label">パキスタン</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="BD">
                                        <label class="form-check-label">バングラデシュ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="LK">
                                        <label class="form-check-label">スリランカ</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <h6>ヨーロッパ</h6>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="GB">
                                        <label class="form-check-label">イギリス</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="FR">
                                        <label class="form-check-label">フランス</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="DE">
                                        <label class="form-check-label">ドイツ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="IT">
                                        <label class="form-check-label">イタリア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="ES">
                                        <label class="form-check-label">スペイン</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PT">
                                        <label class="form-check-label">ポルトガル</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="NL">
                                        <label class="form-check-label">オランダ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="BE">
                                        <label class="form-check-label">ベルギー</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CH">
                                        <label class="form-check-label">スイス</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="AT">
                                        <label class="form-check-label">オーストリア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="SE">
                                        <label class="form-check-label">スウェーデン</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="NO">
                                        <label class="form-check-label">ノルウェー</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="DK">
                                        <label class="form-check-label">デンマーク</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="FI">
                                        <label class="form-check-label">フィンランド</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="IE">
                                        <label class="form-check-label">アイルランド</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PL">
                                        <label class="form-check-label">ポーランド</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CZ">
                                        <label class="form-check-label">チェコ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="HU">
                                        <label class="form-check-label">ハンガリー</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="GR">
                                        <label class="form-check-label">ギリシャ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="RO">
                                        <label class="form-check-label">ルーマニア</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <h6>北米・南米</h6>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="US">
                                        <label class="form-check-label">アメリカ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CA">
                                        <label class="form-check-label">カナダ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="MX">
                                        <label class="form-check-label">メキシコ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="BR">
                                        <label class="form-check-label">ブラジル</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="AR">
                                        <label class="form-check-label">アルゼンチン</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CL">
                                        <label class="form-check-label">チリ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="CO">
                                        <label class="form-check-label">コロンビア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PE">
                                        <label class="form-check-label">ペルー</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="VE">
                                        <label class="form-check-label">ベネズエラ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="EC">
                                        <label class="form-check-label">エクアドル</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="BO">
                                        <label class="form-check-label">ボリビア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="PY">
                                        <label class="form-check-label">パラグアイ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="UY">
                                        <label class="form-check-label">ウルグアイ</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <h6>その他の地域</h6>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="AU">
                                        <label class="form-check-label">オーストラリア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="NZ">
                                        <label class="form-check-label">ニュージーランド</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="RU">
                                        <label class="form-check-label">ロシア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="TR">
                                        <label class="form-check-label">トルコ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="ZA">
                                        <label class="form-check-label">南アフリカ</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="EG">
                                        <label class="form-check-label">エジプト</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="SA">
                                        <label class="form-check-label">サウジアラビア</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="AE">
                                        <label class="form-check-label">アラブ首長国連邦</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="IL">
                                        <label class="form-check-label">イスラエル</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" name="excludedCountries[]" value="IR">
                                        <label class="form-check-label">イラン</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <button type="button" class="btn btn-secondary" id="showMoreCountries">
                                        その他の国を表示 (50カ国以上)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 同意事項 -->
                <div class="terms-section">
                    <div class="form-check mb-3">
                        <input type="checkbox" class="form-check-input" name="agreementAll" required>
                        <label class="form-check-label">所有権等権利紛争に関する全ての情報、他社発売音源の再発売に関する情報、発売国及びプラットフォームに関する情報に同意します。</label>
                    </div>

                    <div class="form-check mb-3">
                        <input type="checkbox" class="form-check-input" name="rightsAgreement" required>
                        <label class="form-check-label">所有権紛争通知に同意します。</label>
                        <div class="terms-content">
                            <p>本有料サービスは、有料利用会員の発売履歴が存在しない、新規の純粋な創作物を対象としています。</p>

                            <p>会員は、流通対象コンテンツに関して、当社に独占的な流通事業権を付与するために必要な適法な著作権、著作隣接権、商標権、意匠権、パブリシティ権等の権利および／または本有料サービスの契約期間中有効な関連使用権限を有していることを保証し、当該コンテンツが第三者の著作権、著作隣接権、商標権、意匠権、パブリシティ権その他正当な法的権利または利益を侵害していないことを保証します。</p>

                            <p>会員は、当社が有料利用契約に基づき、流通対象コンテンツに関して独占的な流通事業を行うにあたり、妨げとなるまたは支障をきたすような一切の約定（口頭・書面を問わず）を締結していないこと、またそのような約定を締結する義務も負っていないこと、さらに、流通対象コンテンツに関して流通事業に必要な一切の権利（著作隣接権を含む）を第三者に譲渡、ライセンス、贈与、担保提供その他の処分を行っておらず、そのような処分を行う義務も負っていないことを保証します。</p>

                            <p>会員は、当社が有料利用契約に基づき、流通対象コンテンツに関して独占的な流通事業を行えるように、契約期間中、(i) 自ら当該コンテンツの流通事業を行わないこと、(ii) 当社以外の第三者に対して当該コンテンツの流通事業権を付与しないこと、(iii) 当該コンテンツの全部または一部を利用または再録音して新たな音源を制作・販売しないこと、またそのための契約を締結しないこと、(iv) その他当社の独占的流通事業権を侵害する一切の法的・事実的行為を行わないことを確約します。</p>

                            <p>有料利用会員が発売したコンテンツについて、当社またはDSPに対し第三者が権利を主張した場合（DSPのカスタマーサポートウェブサイトを通じた間接的な主張も含む）、当社は会員に対し説明を求めることができ、当該説明に基づいて当社は会員を代理して最大2回まで権利を主張することができます。2回の主張後も権利が明確にならない場合や権利紛争が継続する場合、当社は権利の主張を中止または撤回することができます。</p>

                            <p>有料利用会員の説明にもかかわらず、上記第三者の主張に基づく合理的な疑義が引き続き存在する場合、当社はSurroundio利用規約に従って会員に通知のうえ、当該音源および／またはコンテンツの有料サービスを直ちに中止し、該当する収益に対する精算金の支払いを保留することができ、当該保留金に対しては利息が発生しないものとします。ただし、上記第三者の主張に明確な法的根拠がある場合、または即時の中止が必要とされる緊急の事情がある場合には、会員への事前通知なしに当該音源および／またはコンテンツの有料サービスを即時中止し、収益の精算金の支払いを保留することができます。当社は、関連する紛争が法的手続きの確定や当事者間の合意などにより終了した場合、その結果に基づいて会員に対し保留していた精算金を支払います。</p>
                        </div>
                    </div>

                    <div class="form-check mb-3">
                        <input type="checkbox" class="form-check-input" name="reReleaseAgreement" required>
                        <label class="form-check-label">他社発売音源の再発売情報に同意します。</label>
                        <div class="terms-content">
                            <p>本有料サービスでは、過去に他社にて発売または流通された経歴があるコンテンツの重複発売を許可いたしません。</p>

                            <p>ただし、有料利用会員の要請により、既存の権利者から当社へコンテンツの流通権限が移管されることについての書面による同意書を、公文書または電子メールの形式で受領し、アルバム発売日の7日前までに当社宛（kmat0@surroundio.app）に提出した場合に限り、既に発売・流通されたコンテンツが含まれるアルバムの発売を承認します。期日内に当該書面同意書が提出されない場合は、当該トラックを含むアルバムの発売は却下されます。</p>

                            <p>既存権利者の書面による同意手続を経ずにプラットフォームにコンテンツを登録し、アルバム発売を進行した後に、第三者または既存の権利者から権利主張がなされた場合、当社は有料利用会員の同意を得ることなく、該当アルバム全体または特定トラックの流通サービスを直ちに停止することができ、サービス期間中に発生した著作隣接権料の支払いを保留するか、原権利者に対して支払うことができます。</p>

                            <p>万一、第三者または既存の権利者との間で、流通対象コンテンツに関して流通権限の侵害等の理由により紛争が発生した場合、会員は自己の責任と費用負担において当該紛争を解決し、当社が責任を負わないようにしなければなりません。また、これにより当社が費用を負担した場合は、その全額を補償しなければなりません。</p>
                        </div>
                    </div>

                    <div class="form-check mb-3">
                        <input type="checkbox" class="form-check-input" name="platformAgreement" required>
                        <label class="form-check-label">Surroundio発売国及びプラットフォームガイドに同意します。</label>
                        <div class="terms-content">
                            <p>本有料サービスは、有料利用会員が登録・発売したコンテンツを、当社とコンテンツ流通契約関係にあるすべてのDSPおよび各DSPがサービスを提供する全地域に対して流通・供給することを原則とします。</p>

                            <p>ただし、有料利用会員がプラットフォーム上で、特定のDSPまたは国に対してコンテンツの流通・供給を希望しない旨を当社に明示した場合、当社は有料利用会員の要請または条件に従ってコンテンツを流通・供給します。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ジャンル選択 -->
            <div class="form-section">
                <h3 class="mb-4">ジャンル</h3>
                <div class="mb-3">
                    <label for="genre" class="form-label required-label">ジャンルを選択</label>
                    <select class="form-select" id="genre" required>
                        <option value="">ジャンルを選択してください</option>
                        <option value="pop">ポップス</option>
                        <option value="rock">ロック</option>
                        <option value="jazz">ジャズ</option>
                        <option value="classical">クラシック</option>
                        <option value="electronic">エレクトロニック</option>
                        <option value="hiphop">ヒップホップ</option>
                        <option value="rb">R&B</option>
                        <option value="folk">フォーク</option>
                        <option value="world">ワールド</option>
                        <option value="ambient">アンビエント</option>
                        <option value="metal">メタル</option>
                        <option value="blues">ブルース</option>
                        <option value="country">カントリー</option>
                        <option value="experimental">エクスペリメンタル</option>
                        <option value="fusion">フュージョン</option>
                    </select>
                </div>
            </div>

            <!-- YouTube収益化サービス -->
            <div class="form-section">
                <h3 class="mb-4">YouTube収益化サービス</h3>
                <div class="mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="youtubeMonetize" id="youtubeYes" required>
                        <label class="form-check-label" for="youtubeYes">利用する</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="youtubeMonetize" id="youtubeNo">
                        <label class="form-check-label" for="youtubeNo">利用しない</label>
                    </div>
                </div>

                <div class="youtube-terms">
                    <h4>YouTube収益化サービスの内容と注意事項</h4>
                    <p>YouTube収益化サービス*1は第三者がYouTubeにアップロードした動画に会員様の楽曲が使用された場合、音源に関する権利として収益を得ることができるサービスです。ぜひご活用ください。詳しい内容は<a href="#" target="_blank">こちら</a>をクリックしてください。</p>
                    
                    <p>ただし、本サービスで配信された楽曲を使用してYouTubeに動画をアップロードする場合、YouTubeにて「著作権侵害の申し立て」と判断される可能性があります。その際、著作権者として「massenext株式会社（ナラスの代理人）」※2が表示されます。</p>
                    
                    <p>※ この場合の「著作権」は「原盤権（音源に関する権利）」を指します。「作詞または作曲に関する著作権」を指すものではありません。</p>
                    
                    <p>著作権侵害の申し立てを取り下げたい場合は、以下の情報と共にお問い合わせフォームよりご連絡ください：</p>
                    <ul>
                        <li>申し立てられた動画のURL</li>
                        <li>対象楽曲タイトル</li>
                        <li>対象リリースのJANコード</li>
                    </ul>

                    <p>「YouTube収益化サービス」の登録対象外となる楽曲は以下の通りです：</p>
                    <ul>
                        <li>パブリックドメインに帰属する知的創作物を含む楽曲（例：クラシック音楽の音源）</li>
                        <li>第三者が権利を付与またはライセンスを付与した音源を含む楽曲（サンプリングされた音源、許諾された音源など）</li>
                        <li>フリー音源（音楽制作ソフトウェアのループ音源素材、効果音、音源素材など）を含む楽曲</li>
                        <li>原曲と異ならないカバー曲（例：有名アーティストの模倣曲）</li>
                        <li>カラオケ、アカペラ、器楽曲、断片、リマスタリング、原曲のライブバージョンなど</li>
                        <li>オリジナルエディション以外のアルバム（コンピレーションエディション、リマスターエディション、ベストエディション、DJミックスエディションなど）</li>
                        <li>30秒未満の楽曲</li>
                        <li>音楽以外のポッドキャスト、スピーチ、インタビュー、朗読会およびその他のコンテンツ</li>
                        <li>区別が困難な楽曲（例：自然音、環境音、ヨガ、睡眠）</li>
                        <li>当社以外のサービスを通じてYouTubeの「YouTube収益化サービス」に登録された楽曲</li>
                    </ul>

                    <p>※1 「YouTube収益化サービス」に登録すると、YouTube Musicへの配信も自動的に行われます。</p>
                    <p>※2 ナラスはYouTube（Google）と音楽契約を結んでいるmassenext株式会社とビジネス提携を結んでいます。「YouTube収益化サービス」は音楽エージェントサイトZULAを運営する株式会社massenextを通じて運営・管理されます。YouTubeでの「著作権」という表記には「マスター権利」も含まれており、ここでの「著作権」は「マスター権利」を表します。</p>
                </div>

                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="youtubeAgree" required>
                    <label class="form-check-label" for="youtubeAgree">利用規約に同意します</label>
                </div>
            </div>

            <!-- PayPal Section -->
            <div class="form-section">
                <h3 class="mb-4">お支払い</h3>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <div class="alert alert-info" role="alert">
                            <i class="fa fa-info-circle"></i> 料金: 20,000円 (税込)
                        </div>
                        <div id="paypal-button-container" class="text-center"></div>
                        <div id="payment-status" class="payment-status"></div>
                    </div>
                </div>
            </div>

            <!-- 送信ボタン -->
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg">申請する</button>
            </div>
        </form>
    </div>

    <div class="container">
        <div class="footer-flex-container">
            <p class="text-uppercase small templatemo-copyright">Surroundio copyright © 2022 Nationalux Canada, All rights reserved.</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script>
        $(document).ready(function() {
            let songCount = 0;

            // 곡 추가 버튼 클릭 이벤트
            $('#addSongButton').on('click', function() {
                const originalSong = $('#songs-container .song-entry:first').clone();
                songCount++;

                // 새로운 곡 번호 설정
                originalSong.find('.song-number').text(songCount + 1);
                
                // 모든 input, select, textarea 초기화 및 인덱스 업데이트
                originalSong.find('input, select, textarea').each(function() {
                    const elem = $(this);
                    // name 속성 업데이트
                    if (elem.attr('name')) {
                        elem.attr('name', elem.attr('name').replace(/_\d+/, `_${songCount}`));
                    }
                    // id 속성 업데이트
                    if (elem.attr('id')) {
                        elem.attr('id', elem.attr('id').replace(/_\d+/, `_${songCount}`));
                    }
                    // 값 초기화
                    elem.val('');
                });

                // 컨테이너 ID 업데이트
                originalSong.find('[id]').each(function() {
                    const elem = $(this);
                    elem.attr('id', elem.attr('id').replace(/_\d+/, `_${songCount}`));
                });

                // 삭제 버튼 표시 및 이벤트 설정
                originalSong.find('.remove-song').show().on('click', function() {
                    if ($('.song-entry').length > 1) {
                        $(this).closest('.song-entry').remove();
                        updateSongNumbers();
                    }
                });

                // 새로운 곡 추가
                $('#songs-container').append(originalSong);
                
                // 모든 곡의 삭제 버튼 표시 (첫 번째 곡 제외)
                if ($('.song-entry').length > 1) {
                    $('.remove-song').show();
                }
            });

            // 입력 필드 추가 버튼 클릭 이벤트
            $(document).on('click', '.add-field', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const container = $(this).closest('.mb-3');
                const inputGroup = $(this).closest('.input-group');
                const newGroup = inputGroup.clone(true);
                
                // 입력 필드 초기화
                newGroup.find('input').val('');
                
                // 새 입력 그룹 추가
                container.append(newGroup);
                
                // 모든 삭제 버튼 활성화
                container.find('.remove-field').prop('disabled', false);
            });

            // 입력 필드 삭제 버튼 클릭 이벤트
            $(document).on('click', '.remove-field', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const container = $(this).closest('.mb-3');
                const inputGroups = container.find('.input-group');
                
                if (inputGroups.length > 1) {
                    $(this).closest('.input-group').remove();
                    
                    // 마지막 남은 입력 그룹의 삭제 버튼 비활성화
                    if (inputGroups.length === 2) {
                        container.find('.remove-field').last().prop('disabled', true);
                    }
                }
            });

            // 곡 번호 업데이트 함수
            function updateSongNumbers() {
                $('.song-entry').each(function(index) {
                    $(this).find('.song-number').text(index + 1);
                });
            }

            // 초기 상태 설정
            if ($('.song-entry').length === 1) {
                $('.remove-song').hide();
            }

            // 각 섹션의 첫 번째 삭제 버튼 비활성화
            $('.mb-3').each(function() {
                if ($(this).find('.input-group').length === 1) {
                    $(this).find('.remove-field').prop('disabled', true);
                }
            });

            // 폼 제출 이벤트 핸들러
            $('#albumForm').on('submit', async function(e) {
                e.preventDefault();
                
                // 폼 유효성 검사
                if (!this.checkValidity()) {
                    e.stopPropagation();
                    $(this).addClass('was-validated');
                    return;
                }

                // 제출 버튼 비활성화
                const submitButton = $(this).find('button[type="submit"]');
                submitButton.prop('disabled', true);
                submitButton.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> 送信中...');

                try {
                    const formData = new FormData(this);

                    // 앨범 커버 파일 추가
                    const albumCover = $('#albumCover')[0].files[0];
                    if (albumCover) {
                        formData.append('albumCover', albumCover);
                    }

                    // 오디오 파일들 추가
                    $('.song-entry').each(function(index) {
                        const audioFile = $(this).find('input[type="file"]')[0].files[0];
                        if (audioFile) {
                            formData.append(`audio_${index}`, audioFile);
                        }
                    });

                    // API 호출
                    const response = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    
                    // 성공 메시지 표시
                    alert('アルバムの申請が完了しました。');
                    
                    // 예약 확인 페이지로 이동
                    window.location.href = '/reservation.html';

                } catch (error) {
                    console.error('Error:', error);
                    alert('エラーが発生しました。もう一度お試しください。');
                } finally {
                    // 제출 버튼 상태 복구
                    submitButton.prop('disabled', false);
                    submitButton.html('申請する');
                }
            });
        });
    </script>

    <script>
        // PayPal 설정
        paypal.Buttons({
            style: {
                layout: 'vertical',
                color: 'blue',
                shape: 'rect',
                label: 'paypal'
            },
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '20000',
                            currency_code: 'JPY'
                        },
                        description: 'Surroundio音楽配信サービス'
                    }]
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                    // 결제 성공 메시지 표시
                    const paymentStatus = document.getElementById('payment-status');
                    paymentStatus.className = 'payment-status success';
                    paymentStatus.style.display = 'block';
                    paymentStatus.innerHTML = '決済が完了しました。ありがとうございます！';
                    
                    // 제출 버튼 활성화
                    document.querySelector('button[type="submit"]').disabled = false;
                });
            },
            onError: function(err) {
                // 에러 메시지 표시
                const paymentStatus = document.getElementById('payment-status');
                paymentStatus.className = 'payment-status error';
                paymentStatus.style.display = 'block';
                paymentStatus.innerHTML = '決済処理中にエラーが発生しました。もう一度お試しください。';
                console.error('PayPal Error:', err);
            }
        }).render('#paypal-button-container');

        // 초기에 제출 버튼 비활성화
        document.querySelector('button[type="submit"]').disabled = true;
    </script>
</body>
</html> 